# 総合演習（複合フォームの実装）

## 🎯 目的

これまで学習してきたフォーム構築・バリデーション・API通信・状態管理の知識をすべて活用し、  
実践的な複合フォームアプリケーションを一人称で実装できる力を身につける。

---

## 🎯 今週のゴール

- 複数の入力フィールドを持つフォームを React Hook Form + Zod で構築する
- 入力値をバリデーションし、APIに POST 送信できる
- 登録されたデータを SWR で一覧取得・表示できる
- 成功・エラー・ローディング状態に応じた UI を制御できる

---

## ✅ 実装内容

以下の複合フォームを `/memos/new` ページに作成してください：

| 項目         | バリデーション条件              |
|--------------|------------------------------|
| タイトル     | 必須                           |
| 内容         | 10文字以上                     |
| メール       | メール形式、任意               |
| 年齢         | 18歳以上、100歳以下（任意）     |
| 利用規約同意 | チェックされていること（必須） |

- Zod でスキーマを定義し、`zodResolver` で React Hook Form と連携
- バリデーションに通過したら `/api/memos` に POST 送信し、`mutate()` によって最新化する
- 登録成功後は一覧（`/memos`）に遷移 or 成功メッセージを表示
- 一覧ページでは `useSWR` でメモを取得する

---

## 🔄 状態管理・表示例

- ローディング中：送信ボタンを非活性にし、「送信中...」表示
- バリデーションエラー：各フィールドの下にメッセージ表示
- 成功：「登録が完了しました！」メッセージ表示
- 失敗：「送信に失敗しました」などの案内表示

---

## 💬 ワンポイントアドバイス

- `useForm`, `z.object()`, `refine()` など Week9〜11 の復習になります
- POST 成功後の `mutate("/api/memos")` を使って一覧を再取得しましょう
- 入力データの保存処理はバックエンド側に既に実装済みです（ダミーでもOK）

----

## 🔸 補足

データ処理部分はこちらを参考にしてください
``` typescript
// app/api/memos/route.ts

import { NextRequest, NextResponse } from "next/server";

// メモデータのモック保存先（ファイル外部ではなく、リクエスト間で共有しない擬似状態）
let memos = [
  { id: 1, title: "最初のメモ" },
  { id: 2, title: "次のメモ" },
];

// GET: 一覧取得
export async function GET() {
  return NextResponse.json(memos);
}

// POST: 新規メモ追加（受け取ったデータを配列に追加）
export async function POST(req: NextRequest) {
  const body = await req.json();

  const newMemo = {
    id: memos.length + 1,
    title: body.title ?? "(無題)",
  };

  memos.push(newMemo);

  return NextResponse.json({ success: true, memo: newMemo });
}
```

<!-- 課題を提出する際、プルリクエストに以下を貼り付けてください

## 📊 評価チェックリスト（Week 12：複合フォームの総合演習）

※ 各観点ごとにチェック数を数え、下記ルールで点数化  
（チェック数 0個=0点 / 1個=1点 / 2個=3点 / 3個以上=5点）

---

### 🎯 成果物（アウトプットの完成度）

- [ ] 複数項目を持つフォームをReact Hook Formで構築している
- [ ] Zodスキーマを使ったバリデーションが正しく設定されている
- [ ] フォーム送信時にAPI通信が行われている（fetch / API Routes など）
- [ ] 登録後にデータが反映される / リダイレクトされるなど、動作の一連の流れが確認できる

---

### 📚 知識理解（仕組みや構成の理解）※やさしい版

- [ ] 複数項目を1つのフォームで扱うときの構成を理解している
- [ ] Zodスキーマで各項目ごとの条件を定義できている
- [ ] fetchなどでデータを送る処理の仕組みがわかっている
- [ ] ローディング・エラー・成功の状態制御を画面で切り替えている

---

### 💬 説明力（なぜその構成にしたか）※やさしい版

- [ ] どんなフォームを作ったか、どういう項目を入れたかを説明できる
- [ ] なぜそのバリデーションを設定したか話せる
- [ ] API通信の流れ（送信→レスポンス）を説明できる
- [ ] 状態（成功・失敗など）の表示切り替えをどう実装したか説明できる

---

### 🔧 自己修正（修正・改善の自走力）

- [ ] バリデーションミスや送信エラーを自力で調査・修正している
- [ ] ユーザー視点での改善（入力しやすさ / エラー見やすさ）を行っている
- [ ] コードの重複を避けて整理・部品化している形跡がある
- [ ] 一通り完成させたあと、自分で見直しや微修正をしている

---

📝 評価観点ごとのチェック数を数え、以下のように点数に換算してください：

| チェック数 | 点数 |
|------------|------|
| 0個        | 0点  |
| 1個        | 1点  |
| 2個        | 3点  |
| 3〜4個     | 5点  |

-->