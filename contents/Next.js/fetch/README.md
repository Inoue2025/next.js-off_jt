# API通信（フォーム送信・データ取得）

## 🎯 目的

Next.js アプリケーションで外部・内部APIと連携するために、  
API Routes の作成、フォームの送信（POST）、データ取得（GET）を学ぶ。

---

## 🎯 今週のゴール

- Next.js の API Routes を作成し、バックエンド処理を定義できる
- `fetch` を使ってフォーム内容を送信できる
- SWR を使って API からデータを取得して表示できる
- ローディング・エラー・成功時の状態を管理できる

---

## ✅ Next.js API Routes の作成（/api/memos）

[リンク](Next.js%20API%20Routes%20の作成.md)  

---

## ✅ fetch を使ったフォーム送信（POST）

[リンク](fetch%20を使ったフォーム送信（POST）.md)  

---

## ✅ SWR を使ったデータ取得（GET）

[リンク](SWR%20を使ったデータ取得（GET）.md)  

---

## ✅ 成功・失敗・ローディングの状態制御

[リンク](ローディング・エラー・成功時の状態制御.md)  

---

## 🔹 課題内容

メモ一覧ページで、APIから取得したデータを表示してみましょう。

- ダミーAPI（例：`/api/memos`）でメモ一覧を返す
- `useSWR` を使ってデータを取得・レンダリング

---

## 🔹 実装条件

- `useSWR` を使って `/api/memos` を呼び出す
- ローディング中は「読み込み中...」を表示
- エラー時は「取得に失敗しました」と表示
- 正常時は `ul > li` の形式でメモのタイトルを表示

---

## 🔸 補足

データ処理部分はこちらを参考にしてください
``` typescript
// app/api/memos/route.ts

import { NextRequest, NextResponse } from "next/server";

// メモデータのモック保存先（ファイル外部ではなく、リクエスト間で共有しない擬似状態）
let memos = [
  { id: 1, title: "最初のメモ" },
  { id: 2, title: "次のメモ" },
];

// GET: 一覧取得
export async function GET() {
  return NextResponse.json(memos);
}

// POST: 新規メモ追加（受け取ったデータを配列に追加）
export async function POST(req: NextRequest) {
  const body = await req.json();

  const newMemo = {
    id: memos.length + 1,
    title: body.title ?? "(無題)",
  };

  memos.push(newMemo);

  return NextResponse.json({ success: true, memo: newMemo });
}
```

<!-- 課題を提出する際、プルリクエストに以下を貼り付けてください

## 📊 評価チェックリスト（Week 13：API通信 - フォーム送信・データ取得）

※ 各観点ごとにチェック数を数え、下記ルールで点数化  
（チェック数 0個=0点 / 1個=1点 / 2個=3点 / 3個以上=5点）

---

### 🎯 成果物（アウトプットの完成度）

- [ ] `fetch` を使ったフォーム送信（POST）が実装されている
- [ ] Next.js API Routes が `/api/...` で定義されている
- [ ] `useSWR` でGET通信を行い、データが画面に表示されている
- [ ] `mutate()` で再取得が実装されている

---

### 📚 知識理解（仕組みや構成の理解）※やさしい版

- [ ] `fetch` を使うとデータを送信・取得できることを理解している
- [ ] Next.jsでは `pages/api/` 配下でAPIを作れることを知っている
- [ ] `useSWR` はデータ取得と自動更新のライブラリであると理解している
- [ ] 通信状態（読み込み中・失敗・成功）の考え方を理解している

---

### 💬 説明力（なぜその構成にしたか）※やさしい版

- [ ] どんなデータを送信・取得しているか説明できる
- [ ] APIの定義場所・使い方を説明できる（例：`pages/api/memos.ts`）
- [ ] `useSWR` の使い方や、なぜ使ったかを説明できる
- [ ] 通信結果に応じて、どのようなUI制御をしたか話せる

---

### 🔧 自己修正（修正・改善の自走力）

- [ ] 通信エラーやデータ取得ミスを自力で発見・修正している
- [ ] `fetch` のリクエスト/レスポンス形式を確認・調整している
- [ ] APIの戻り値を整形・扱いやすくするなど工夫している
- [ ] UI側でローディング・エラー表示を工夫して改善している

---

📝 評価観点ごとのチェック数を数え、以下のように点数に換算してください：

| チェック数 | 点数 |
|------------|------|
| 0個        | 0点  |
| 1個        | 1点  |
| 2個        | 3点  |
| 3〜4個     | 5点  |

-->